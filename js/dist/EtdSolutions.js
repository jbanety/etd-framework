
!function(e){function n(){var e=arguments[0],r=n.cache;return r[e]&&r.hasOwnProperty(e)||(r[e]=n.parse(e)),n.format.call(null,r[e],arguments)}function r(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,n){return Array(n+1).join(e)}var s={not_string:/[^s]/,number:/[def]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};n.format=function(e,i){var o,a,l,f,c,p,u,d=1,g=e.length,h="",x=[],b=!0,y="";for(a=0;g>a;a++)if(h=r(e[a]),"string"===h)x[x.length]=e[a];else if("array"===h){if(f=e[a],f[2])for(o=i[d],l=0;l<f[2].length;l++){if(!o.hasOwnProperty(f[2][l]))throw new Error(n("[sprintf] property '%s' does not exist",f[2][l]));o=o[f[2][l]]}else o=f[1]?i[f[1]]:i[d++];if("function"==r(o)&&(o=o()),s.not_string.test(f[8])&&"number"!=r(o)&&isNaN(o))throw new TypeError(n("[sprintf] expecting number but found %s",r(o)));switch(s.number.test(f[8])&&(b=o>=0),f[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=f[7]?o.toExponential(f[7]):o.toExponential();break;case"f":o=f[7]?parseFloat(o).toFixed(f[7]):parseFloat(o);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&f[7]?o.substring(0,f[7]):o;break;case"u":o>>>=0;break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}(!b||s.number.test(f[8])&&f[3])&&(y=b?"+":"-",o=o.toString().replace(s.sign,"")),p=f[4]?"0"==f[4]?"0":f[4].charAt(1):" ",u=f[6]-(y+o).length,c=f[6]?t(p,u):"",x[x.length]=f[5]?y+o+c:0==p?y+c+o:c+y+o}return x.join("")},n.cache={},n.parse=function(e){for(var n=e,r=[],t=[],i=0;n;){if(null!==(r=s.text.exec(n)))t[t.length]=r[0];else if(null!==(r=s.modulo.exec(n)))t[t.length]="%";else{if(null===(r=s.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(r[2]){i|=1;var o=[],a=r[2],l=[];if(null===(l=s.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o[o.length]=l[1];""!==(a=a.substring(l[0].length));)if(null!==(l=s.key_access.exec(a)))o[o.length]=l[1];else{if(null===(l=s.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");o[o.length]=l[1]}r[2]=o}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");t[t.length]=r}n=n.substring(r[0].length)}return t};var i=function(e,r,t){return t=(r||[]).slice(0),t.splice(0,0,e),n.apply(null,t)};"undefined"!=typeof exports?(exports.sprintf=n,exports.vsprintf=i):(e.sprintf=n,e.vsprintf=i,"function"==typeof define&&define.amd&&define(function(){return{sprintf:n,vsprintf:i}}))}("undefined"==typeof window?this:window);
if("undefined"==typeof EtdSolutions)var EtdSolutions={};
EtdSolutions.Framework={version:"0.0.1"};
EtdSolutions.Framework.Form={$form:null,options:{ajaxURI:null,token:null,data:{},itemView:null,listView:null,selectors:{checkboxes:".list-col-cb input",itemButtons:".btn-list",limitInput:"#limit",checkAll:'input[name="checkAll"]',taskInput:'input[name="task"]'}},init:function(t,i){return this.$form=$(t),$.extend(!0,this.options,i),this.$form.find(this.options.selectors.itemButtons).on("click",$.proxy(this.onListBtnClick,this)),$(this.options.selectors.limitInput).on("change",$.proxy(this.onLimitChange,this)),this.$form.find(this.options.selectors.checkAll).on("change",$.proxy(this.onCheckAllChange,this)),this},prepareEditRow:function(t){t=$(t);var i=this,n=t.find(".inline-edit-input");return t.find(".inline-edit-btn").on("click",function(i){i.preventDefault(),console.log(n.val()),n.data("prev-value",n.val()),t.addClass("editing")}),t.find(".inline-cancel-btn").on("click",function(i){i.preventDefault(),n.val(n.data("prev-value")),t.removeClass("editing")}),t.find(".inline-save-btn").on("click",function(e){e.preventDefault();var o={task:"updateField",name:n.attr("name"),value:n.val()};i.postAjax(o,function(){t.removeClass("editing")},function(){n.val(n.data("prev-value")),t.removeClass("editing")})}),this},postAjax:function(t,i,n){return t=$.extend(this.options.data,t),t[this.options.token]="1",$.post(this.options.ajaxURI,t,function(t){t.error&&n?n(t):i&&i(t)}),this},setAjaxURI:function(t){return this.options.ajaxURI=t,this},setAdditionnalData:function(t){return this.options.data=t,this},addSelectTask:function(t,i){var n=this;return $("#"+t).on("click",function(t){t.preventDefault(),n.$form.find(this.options.selectors.checkboxes+":checked").length>0?n.submitTask(i,n.options.itemView):alert(EtdSolutions.Framework.Language.Text._("APP_ERROR_NO_ITEM_SELECTED"))}),this},addSubmitTask:function(t,i,n){var e=this;return $("#"+t).on("click",function(t){t.preventDefault(),e.submitTask(i,n)}),this},addValidationTask:function(t,i,n){var e=this;return $("#"+t).on("click",function(t){t.preventDefault(),e.validate()&&e.submitTask(i,n)}),this},submitTask:function(t,i){return i&&this.$form.attr("action","/"+i),this.$form.find(this.options.selectors.taskInput).val(t),this.$form.submit(),this},validate:function(){return!0},onListBtnClick:function(t){t.preventDefault();var i=$(t.delegateTarget),n=i.attr("href").split("/").splice(1);return this.$form.find(this.options.selectors.checkboxes).prop("checked",!1),this.$form.find(this.options.selectors.checkboxes+'[value="'+n.pop()+'"]').prop("checked",!0),this.$form.find(this.options.selectors.taskInput).val(n.pop()),this.$form.attr("action","/"+n.join("/")),this.$form.submit(),this},onLimitChange:function(t){return t.preventDefault(),this.$form.attr("action","/"+this.options.listView),this.$form.submit(),this},onCheckAllChange:function(){return this.$form.find(this.options.selectors.checkboxes).prop("checked",$(this.options.selectors.checkAll).prop("checked")),this}};
EtdSolutions.Framework.Language={};
EtdSolutions.Framework.Language.Text={strings:{},_:function(t){return this.strings[t.toUpperCase()]},plural:function(t,r){var n,s=!1,e=this.getPluralSuffixes(r);return e.unshift(r),$.each(e,function(r,e){return n=t+"_"+e,EtdSolutions.Framework.Language.Text.strings.hasOwnProperty(n)?(s=!0,!1):!0}),s||(n=t),n=this._(n),sprintf.call(this,n,r)},sprintf:function(){return arguments.length>0?(arguments[0]=EtdSolutions.Framework.Language.Text._(arguments[0]),sprintf.apply(this,arguments)):""},load:function(t){for(var r in t)t.hasOwnProperty(r)&&(this.strings[r.toUpperCase()]=t[r]);return this},getPluralSuffixes:function(t){var r;return r=0==t?["0"]:1==t?["1"]:["MORE"]}};